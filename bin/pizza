#!/usr/bin/env bash

readonly file=$1
readonly threshold=$2

if [ $# -lt 2 ]; then
  echo >&2 "Usage: $0 <file_name> <lines_per_split>"
  exit 1
fi

readonly total_lines=$(wc -l < "$file" | xargs)
current_line=0
till_line=0
part=1

while (( current_line <= total_lines )); do
  current_line=$(( till_line+1 ))
  till_line=$((current_line+threshold-1))
  if (( till_line > total_lines )); then
    till_line=$total_lines
  fi
  sed -n -e "${current_line},${till_line}p" "${file}" > "${file}"-"${part}"-"${current_line}"-"${till_line}"
  part=$(( part+1 ))
done
